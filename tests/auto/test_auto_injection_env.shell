. ./assert.sh
. otel.sh

_otel_inject_inner_command_args env echo hello world 1
sleep 3
eval "$(_otel_inject_inner_command_args env echo hello world 2)"
sleep 3

env echo hello world
assert_equals 0 $?
span="$(resolve_span '.name == "env echo hello world"')"
assert_equals "SpanKind.INTERNAL" "$(\echo "$span" | jq -r '.kind')"
span="$(resolve_span '.name == "echo hello world"')"
assert_equals "SpanKind.INTERNAL" "$(\echo "$span" | jq -r '.kind')"
assert_equals "env echo hello world" "$(\echo "$span" | jq -r '.resource.attributes."process.command_line"')"
