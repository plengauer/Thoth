if ! type strace; then exit 0; fi

. ./assert.sh
export OTEL_SHELL_CONFIG_OBSERVE_SUBPROCESSES=TRUE
. otel.sh

# otel_init
sudo apt-get update
# otel_shutdown

span="$(resolve_span '.name == "touch /var/lib/apt/periodic/update-success-stamp"')"
while [ -n "$span" ] && [ "$(printf '%s' "$span" | jq -r '.name')" != "sudo apt-get update" ]; do
  span_id="$(printf '%s' "$span" | jq -r '.context.span_id')"
  span="$(resolve span '.context.span_id == "'"$span_id"'"')"
done
[ -n "$span" ]
